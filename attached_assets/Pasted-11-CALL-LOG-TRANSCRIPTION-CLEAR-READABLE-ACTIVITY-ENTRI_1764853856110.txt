11. CALL LOG & TRANSCRIPTION ‚Äì CLEAR, READABLE ACTIVITY ENTRIES

Upgrade the Activity system on the Lead so it supports a proper Call Log with:
	‚Ä¢	Clear visual layout
	‚Ä¢	Direction (staff ‚Üí client vs client ‚Üí Probuild)
	‚Ä¢	Who handled the call
	‚Ä¢	Date & time (top-right)
	‚Ä¢	Duration
	‚Ä¢	AI summary of the call
	‚Ä¢	Collapsible full transcription + audio playback
	‚Ä¢	Ability to create Tasks directly from the call entry

All of this must be visible in the Activity tab on the Lead Card, and persist when the Lead becomes a Job.

‚∏ª

11.1 Data Model (Call Activity Fields)

Extend the Activity model for call-type entries with:
	‚Ä¢	activity_type = "call"
	‚Ä¢	call_direction (enum: outbound_staff_to_client, inbound_client_to_probuild)
	‚Ä¢	call_timestamp (datetime ‚Äì when the call started)
	‚Ä¢	call_duration_seconds (integer)
	‚Ä¢	staff_member_id (which staff member handled the call)
	‚Ä¢	logged_by_user_id (who logged the call, if different)
	‚Ä¢	call_notes (short editable notes)
	‚Ä¢	audio_recording_url (optional, for playback)
	‚Ä¢	ai_summary_text (short AI-generated summary)
	‚Ä¢	call_transcription_text (full transcript)
	‚Ä¢	transcription_status (pending / completed / failed)

Each call Activity must also be linked to any Tasks created from it (see 11.4).

‚∏ª

11.2 Call Log UI ‚Äì Layout & Clarity

In the Activity tab of a Lead Card, each call entry must be visually clear and not cramped.

Call entry layout:
	‚Ä¢	Top row:
	‚Ä¢	Left:
	‚Ä¢	Icon + direction label, e.g.:
	‚Ä¢	üìû Staff ‚Üí Client for outbound
	‚Ä¢	üìû Client ‚Üí Probuild for inbound
	‚Ä¢	Staff member name:
	‚Ä¢	Handled by: [Staff Name]
	‚Ä¢	Right (top-right corner):
	‚Ä¢	Date and time of call, formatted clearly
	‚Ä¢	e.g. Wed 4 Dec 2025 ¬∑ 9:22am
	‚Ä¢	Duration, e.g. 2 min 45 sec
	‚Ä¢	Second row (main body):
	‚Ä¢	Short AI Summary of the call in plain language, e.g.:
‚ÄúClient asked about moving the install date to next week and requested confirmation on gate height and colour.‚Äù
	‚Ä¢	Below summary:
	‚Ä¢	A clearly labeled button or toggle:
	‚Ä¢	‚ñº View full call details / ‚ñ≤ Hide call details

When the user clicks View full call details, a collapsible panel opens.

‚∏ª

11.3 Expanded Call Details (Collapsible Panel)

Inside the expanded view for a call:
	1.	Full Transcription Section
	‚Ä¢	Label: Full transcription
	‚Ä¢	Display the full call_transcription_text in a scrollable area.
	‚Ä¢	If transcription is not available:
	‚Ä¢	Show a message like:
‚ÄúTranscription not available yet. You can use call notes above.‚Äù
	2.	Audio Playback
	‚Ä¢	If audio_recording_url exists:
	‚Ä¢	Show a basic audio player (play/pause, scrub bar).
	‚Ä¢	Label: Play call recording
	‚Ä¢	If no recording:
	‚Ä¢	Hide player or show: ‚ÄúNo recording available.‚Äù
	3.	Manual Notes
	‚Ä¢	A text area for call_notes:
	‚Ä¢	Editable by staff (with usual permissions).
	‚Ä¢	For additional context beyond the AI summary and transcription.

All sections must have clear spacing and labels so the content is not crammed together.

‚∏ª

11.4 Tasks & Follow-ups Created From Call

From within the call log entry (either in collapsed or expanded view), staff must be able to:
	‚Ä¢	Click a button: ‚ÄúAdd follow-up task‚Äù or similar.
	‚Ä¢	This opens a simple task form linked to:
	‚Ä¢	The Lead
	‚Ä¢	The specific call Activity

Task fields:
	‚Ä¢	Title (e.g. ‚ÄúSend revised quote Q2‚Äù / ‚ÄúConfirm install date‚Äù)
	‚Ä¢	Due date
	‚Ä¢	Assigned staff member
	‚Ä¢	Optional notes

After a Task is created:
	‚Ä¢	The call entry should show a small area e.g.:
	‚Ä¢	Tasks from this call:
	‚Ä¢	‚Ä¢ Follow up with client on colour choice ‚Äì Due Fri 6 Dec ‚Äì Assigned to Ayesha
	‚Ä¢	Clicking a task opens/edit it in the Task system.

This ensures follow-up actions from calls are visible and tied back to that specific conversation.

‚∏ª

11.5 Editing & Deleting Call Logs

Users must be able to:
	‚Ä¢	Edit a call entry:
	‚Ä¢	call_notes
	‚Ä¢	staff_member_id
	‚Ä¢	(optionally) call direction, if it was logged incorrectly
	‚Ä¢	Delete a call entry:
	‚Ä¢	Only allowed for:
	‚Ä¢	Admin/Owner
	‚Ä¢	Manager-level role
	‚Ä¢	Or the user who originally created the log
	‚Ä¢	Deletion requires confirmation:
	‚Ä¢	‚ÄúAre you sure you want to delete this call log? This will remove it from the Lead‚Äôs history.‚Äù

When deleted, any linked Tasks should remain, but keep their relation to the Lead; the link to the call can either be cleared or noted as ‚ÄúCall log deleted.‚Äù

‚∏ª

11.6 Future Integration ‚Äì AI Transcription Flow (RingCentral/Twilio)

The system must be structured so later we can plug in AI transcription from RingCentral, Twilio, or other providers.

Expected future behaviour (do not fully implement integrations now, just design for it):
	‚Ä¢	Calls made or received through the phone system are associated with:
	‚Ä¢	Lead
	‚Ä¢	call_timestamp
	‚Ä¢	audio_recording_url
	‚Ä¢	A background process or webhook generates call_transcription_text and ai_summary_text, and updates:
	‚Ä¢	transcription_status = completed
	‚Ä¢	When transcription arrives:
	‚Ä¢	The call entry in the Activity tab automatically updates to show:
	‚Ä¢	AI summary (if not manually overridden)
	‚Ä¢	Full transcription in the expanded panel.

Manual call logging must still be possible even without this integration.

‚∏ª

11.7 Persistence Into Job History

When a Lead converts into a Job:
	‚Ä¢	All Activity entries (including call logs, summaries, tasks) must remain visible under the Job‚Äôs history or combined Lead+Job timeline.
	‚Ä¢	Call logs should still show:
	‚Ä¢	Direction
	‚Ä¢	Who handled it
	‚Ä¢	Date/time
	‚Ä¢	Duration
	‚Ä¢	Summary
	‚Ä¢	Tasks created

This gives Scheduler, Production, and Installers full context about earlier conversations.